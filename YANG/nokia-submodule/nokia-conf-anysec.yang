submodule nokia-conf-anysec {

    yang-version "1.1";

    belongs-to nokia-conf { prefix "conf"; }

    import nokia-sros-yang-extensions     { prefix "sros-ext"; }
    import nokia-types-router             { prefix "types-router"; }
    import nokia-types-security           { prefix "types-security"; }
    import nokia-types-sros               { prefix "types-sros"; }

    include nokia-conf-groups;
    include nokia-conf-macsec;
    include nokia-conf-router;

    sros-ext:sros-major-release "rel23";
    organization "Nokia";
    contact
        "Nokia SR OS Support
         Web: <http://www.nokia.com>";
    description
        "Nokia YANG Data model to configure ANYsec on SR OS based routers.

         Copyright 2016 Nokia. All rights reserved. Reproduction of this document
         is authorized on the condition that the foregoing copyright notice is included.

         This nokia-conf-anysec YANG module embodies Nokia's proprietary
         intellectual property. Nokia retains all title and ownership in the
         specification, including any revisions.

         Nokia grants all interested parties a non-exclusive license to use
         and distribute an unmodified copy of this specification in connection with
         management of Nokia products, and without fee, provided this
         copyright notice and license appear on all copies.

         This specification is supplied `as is', and Nokia makes no warranty,
         either express or implied, as to the use, operation, condition, or performance
         of the specification.";
    revision "2023-03-22";

    grouping conf-anysec {
        ///nokia-conf/configure/anysec
        container anysec {
            description "Enter the anysec context";

            ///nokia-conf/configure/anysec/reserved-label-block
            leaf reserved-label-block {
                type leafref {
                    path "../../router/mpls-labels/reserved-label-block/label-block-name";
                }
                description "ANYSec reserved label block";
            }

            ///nokia-conf/configure/anysec/apply-groups
            leaf-list apply-groups {
                type leafref {
                    path "../../groups/group/name";
                }
                max-elements 8;
                ordered-by user;
                description "Apply a configuration group at this level";
            }

            ///nokia-conf/configure/anysec/apply-groups-exclude
            leaf-list apply-groups-exclude {
                type leafref {
                    path "../../groups/group/name";
                }
                max-elements 8;
                ordered-by user;
                description "Exclude a configuration group at this level";
            }

            ///nokia-conf/configure/anysec/mka-over-ip
            container mka-over-ip {
                description "Enter the mka-over-ip context";

                ///nokia-conf/configure/anysec/mka-over-ip/mka-udp-port
                leaf mka-udp-port {
                    type types-sros:tcp-udp-port {
                        range "1024..49151";
                    }
                    description "ANYSec MKA UDP port";
                }

            } // container mka-over-ip

            ///nokia-conf/configure/anysec/tunnel-encryption
            container tunnel-encryption {
                description "Enter the tunnel-encryption context";

                ///nokia-conf/configure/anysec/tunnel-encryption/security-termination-policy
                list security-termination-policy {
                    key "policy-name";
                    max-elements 512;
                    description "Enter the security-termination-policy list instance";

                    ///nokia-conf/configure/anysec/tunnel-encryption/security-termination-policy/policy-name
                    leaf policy-name {
                        type types-sros:named-item-64;
                        description "ANYSec security termination policy name";
                    }

                    ///nokia-conf/configure/anysec/tunnel-encryption/security-termination-policy/local-address
                    leaf local-address {
                        type types-sros:ip-unicast-address;
                        sros-ext:auto-restart-to-modify;
                        description "Local address";
                    }

                    ///nokia-conf/configure/anysec/tunnel-encryption/security-termination-policy/rx-must-be-encrypted
                    leaf rx-must-be-encrypted {
                        type boolean;
                        default "false";
                        description "Enforce encryption for received packets";
                    }

                    ///nokia-conf/configure/anysec/tunnel-encryption/security-termination-policy/admin-state
                    leaf admin-state {
                        type types-sros:admin-state;
                        default "disable";
                        description "Administrative state of the security termination policy";
                    }

                    ///nokia-conf/configure/anysec/tunnel-encryption/security-termination-policy/routing-protocol
                    leaf routing-protocol {
                        type types-security:anysec-routing-protocol;
                        sros-ext:auto-restart-to-modify;
                        description "Routing protocol";
                    }

                    ///nokia-conf/configure/anysec/tunnel-encryption/security-termination-policy/igp-instance-id
                    leaf igp-instance-id {
                        type types-security:anysec-igp-instance-id;
                        sros-ext:auto-restart-to-modify;
                        description "IGP instance ID";
                    }

                    ///nokia-conf/configure/anysec/tunnel-encryption/security-termination-policy/flex-algo-id
                    leaf flex-algo-id {
                        type types-router:flex-algo-id;
                        sros-ext:auto-restart-to-modify;
                        description "Flexible algorithm ID";
                    }

                    ///nokia-conf/configure/anysec/tunnel-encryption/security-termination-policy/apply-groups
                    leaf-list apply-groups {
                        type leafref {
                            path "../../../../groups/group/name";
                        }
                        max-elements 8;
                        ordered-by user;
                        sros-ext:auto-restart-to-modify;
                        description "Apply a configuration group at this level";
                    }

                    ///nokia-conf/configure/anysec/tunnel-encryption/security-termination-policy/apply-groups-exclude
                    leaf-list apply-groups-exclude {
                        type leafref {
                            path "../../../../groups/group/name";
                        }
                        max-elements 8;
                        ordered-by user;
                        sros-ext:auto-restart-to-modify;
                        description "Exclude a configuration group at this level";
                    }

                } // list security-termination-policy

                ///nokia-conf/configure/anysec/tunnel-encryption/encryption-group
                list encryption-group {
                    key "group-name";
                    max-elements 512;
                    description "Enter the encryption-group list instance";

                    ///nokia-conf/configure/anysec/tunnel-encryption/encryption-group/group-name
                    leaf group-name {
                        type types-sros:named-item;
                        description "ANYSec encryption group name";
                    }

                    ///nokia-conf/configure/anysec/tunnel-encryption/encryption-group/security-termination-policy
                    leaf security-termination-policy {
                        type leafref {
                            path "../../security-termination-policy/policy-name";
                        }
                        sros-ext:auto-restart-to-modify;
                        description "Security termination policy used by encryption group";
                    }

                    ///nokia-conf/configure/anysec/tunnel-encryption/encryption-group/encryption-label
                    leaf encryption-label {
                        type types-sros:mpls-label-or-zero;
                        sros-ext:auto-restart-to-modify;
                        description "Label identifying packets sent from the node to peers";
                    }

                    ///nokia-conf/configure/anysec/tunnel-encryption/encryption-group/ca-name
                    leaf ca-name {
                        type leafref {
                            path "../../../../macsec/connectivity-association/ca-name";
                        }
                        sros-ext:auto-restart-to-modify;
                        description "MACSec connectivity association for encryption group";
                    }

                    ///nokia-conf/configure/anysec/tunnel-encryption/encryption-group/admin-state
                    leaf admin-state {
                        type types-sros:admin-state;
                        default "disable";
                        description "Enable or disable encryption group";
                    }

                    ///nokia-conf/configure/anysec/tunnel-encryption/encryption-group/apply-groups
                    leaf-list apply-groups {
                        type leafref {
                            path "../../../../groups/group/name";
                        }
                        max-elements 8;
                        ordered-by user;
                        sros-ext:auto-restart-to-modify;
                        description "Apply a configuration group at this level";
                    }

                    ///nokia-conf/configure/anysec/tunnel-encryption/encryption-group/apply-groups-exclude
                    leaf-list apply-groups-exclude {
                        type leafref {
                            path "../../../../groups/group/name";
                        }
                        max-elements 8;
                        ordered-by user;
                        sros-ext:auto-restart-to-modify;
                        description "Exclude a configuration group at this level";
                    }

                    ///nokia-conf/configure/anysec/tunnel-encryption/encryption-group/peer-tunnel-attributes
                    container peer-tunnel-attributes {
                        sros-ext:auto-restart-to-modify;
                        description "Enter the peer-tunnel-attributes context";

                        ///nokia-conf/configure/anysec/tunnel-encryption/encryption-group/peer-tunnel-attributes/routing-protocol
                        leaf routing-protocol {
                            type types-security:anysec-routing-protocol;
                            sros-ext:auto-restart-to-modify;
                            description "Routing protocol";
                        }

                        ///nokia-conf/configure/anysec/tunnel-encryption/encryption-group/peer-tunnel-attributes/igp-instance-id
                        leaf igp-instance-id {
                            type types-security:anysec-igp-instance-id;
                            sros-ext:auto-restart-to-modify;
                            description "IGP instance ID";
                        }

                        ///nokia-conf/configure/anysec/tunnel-encryption/encryption-group/peer-tunnel-attributes/flex-algo-id
                        leaf flex-algo-id {
                            type types-router:flex-algo-id;
                            sros-ext:auto-restart-to-modify;
                            description "Flexible algorithm ID";
                        }

                    } // container peer-tunnel-attributes

                    ///nokia-conf/configure/anysec/tunnel-encryption/encryption-group/peer
                    list peer {
                        key "peer-ip-address";
                        max-elements 512;
                        description "Enter the peer list instance";

                        ///nokia-conf/configure/anysec/tunnel-encryption/encryption-group/peer/peer-ip-address
                        leaf peer-ip-address {
                            type types-sros:ip-unicast-address;
                            description "Peer IP address";
                        }

                        ///nokia-conf/configure/anysec/tunnel-encryption/encryption-group/peer/encryption-label
                        leaf encryption-label {
                            type types-sros:mpls-label-or-zero;
                            sros-ext:auto-restart-to-modify;
                            description "Label identifying packets sent from the peer";
                        }

                        ///nokia-conf/configure/anysec/tunnel-encryption/encryption-group/peer/admin-state
                        leaf admin-state {
                            type types-sros:admin-state;
                            default "disable";
                            description "Administrative state of the encryption group peer";
                        }

                        ///nokia-conf/configure/anysec/tunnel-encryption/encryption-group/peer/apply-groups
                        leaf-list apply-groups {
                            type leafref {
                                path "../../../../../groups/group/name";
                            }
                            max-elements 8;
                            ordered-by user;
                            sros-ext:auto-restart-to-modify;
                            description "Apply a configuration group at this level";
                        }

                        ///nokia-conf/configure/anysec/tunnel-encryption/encryption-group/peer/apply-groups-exclude
                        leaf-list apply-groups-exclude {
                            type leafref {
                                path "../../../../../groups/group/name";
                            }
                            max-elements 8;
                            ordered-by user;
                            sros-ext:auto-restart-to-modify;
                            description "Exclude a configuration group at this level";
                        }

                    } // list peer

                } // list encryption-group

            } // container tunnel-encryption

        } // container anysec

    } // grouping conf-anysec

}
