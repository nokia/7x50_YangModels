submodule nokia-conf-system-security-user-parameters {

    yang-version "1.1";

    belongs-to nokia-conf { prefix "conf"; }

    import nokia-sros-yang-extensions     { prefix "sros-ext"; }
    import nokia-types-security           { prefix "types-security"; }
    import nokia-types-sros               { prefix "types-sros"; }
    import nokia-types-system             { prefix "types-system"; }

    include nokia-conf-groups;
    include nokia-conf-system;
    include nokia-conf-system-security;
    include nokia-conf-system-security-aaa;

    sros-ext:sros-major-release "rel23";
    organization "Nokia";
    contact
        "Nokia SR OS Support
         Web: <http://www.nokia.com>";
    description
        "Nokia YANG Data model to configure user and password parameters. on SR OS based routers.

         Copyright 2016 Nokia. All rights reserved. Reproduction of this document
         is authorized on the condition that the foregoing copyright notice is included.

         This nokia-conf-system-security-user-parameters YANG module embodies Nokia's proprietary
         intellectual property. Nokia retains all title and ownership in the
         specification, including any revisions.

         Nokia grants all interested parties a non-exclusive license to use
         and distribute an unmodified copy of this specification in connection with
         management of Nokia products, and without fee, provided this
         copyright notice and license appear on all copies.

         This specification is supplied `as is', and Nokia makes no warranty,
         either express or implied, as to the use, operation, condition, or performance
         of the specification.";
    revision "2023-03-17";

    grouping conf-system-security-user-parameters-user-params {
        ///nokia-conf/configure/system/security/user-params
        container user-params {
            description "Enter the user-params context";

            ///nokia-conf/configure/system/security/user-params/apply-groups
            leaf-list apply-groups {
                type leafref {
                    path "../../../../groups/group/name";
                }
                max-elements 8;
                ordered-by user;
                description "Apply a configuration group at this level";
            }

            ///nokia-conf/configure/system/security/user-params/apply-groups-exclude
            leaf-list apply-groups-exclude {
                type leafref {
                    path "../../../../groups/group/name";
                }
                max-elements 8;
                ordered-by user;
                description "Exclude a configuration group at this level";
            }

            ///nokia-conf/configure/system/security/user-params/attempts
            container attempts {
                description "Enter the attempts context";

                ///nokia-conf/configure/system/security/user-params/attempts/count
                leaf count {
                    type uint32 {
                        range "1..64";
                    }
                    default "3";
                    description "Number of unsuccessful login attempts";
                }

                ///nokia-conf/configure/system/security/user-params/attempts/time
                leaf time {
                    type uint32 {
                        range "0..60";
                    }
                    units "minutes";
                    default "5";
                    description "Time frame of unsuccessful login attempts";
                }

                ///nokia-conf/configure/system/security/user-params/attempts/lockout
                leaf lockout {
                    type uint32 {
                        range "0..1440";
                    }
                    units "minutes";
                    default "10";
                    description "Lockout period after unsuccessful login attempts";
                }

            } // container attempts

            ///nokia-conf/configure/system/security/user-params/authentication-order
            container authentication-order {
                description "Enter the authentication-order context";

                ///nokia-conf/configure/system/security/user-params/authentication-order/order
                leaf-list order {
                    type types-security:password-authentication-order;
                    max-elements 4;
                    ordered-by user;
                    description "Preferred order of password authentication";
                }

                ///nokia-conf/configure/system/security/user-params/authentication-order/exit-on-reject
                leaf exit-on-reject {
                    type boolean;
                    default "false";
                    description "Ignore subsequent AAA methods after a reject";
                }

            } // container authentication-order

            ///nokia-conf/configure/system/security/user-params/local-user
            container local-user {
                description "Enter the local-user context";

                ///nokia-conf/configure/system/security/user-params/local-user/password
                container password {
                    description "Enable the password context";

                    ///nokia-conf/configure/system/security/user-params/local-user/password/aging
                    leaf aging {
                        type uint32 {
                            range "1..500";
                        }
                        units "days";
                        description "Maximum time during which a user password is valid";
                    }

                    ///nokia-conf/configure/system/security/user-params/local-user/password/hashing
                    leaf hashing {
                        type enumeration {
                            enum bcrypt                         { value 1; }
                            enum sha2-pbkdf2                    { value 2; }
                            enum sha3-pbkdf2                    { value 3; }
                        }
                        default "bcrypt";
                        description "Hashing algorithm for user passwords";
                    }

                    ///nokia-conf/configure/system/security/user-params/local-user/password/history-size
                    leaf history-size {
                        type uint32 {
                            range "0..20";
                        }
                        description "Number of previous passwords to compare against";
                    }

                    ///nokia-conf/configure/system/security/user-params/local-user/password/minimum-age
                    leaf minimum-age {
                        type types-sros:time-duration {
                            range "0..86400";
                        }
                        units "seconds";
                        default "600";
                        description "Minimum age required for a password before changing it";
                    }

                    ///nokia-conf/configure/system/security/user-params/local-user/password/minimum-change
                    leaf minimum-change {
                        type uint32 {
                            range "1..20";
                        }
                        default "5";
                        description "Minimum character differences between passwords";
                    }

                    ///nokia-conf/configure/system/security/user-params/local-user/password/apply-groups
                    leaf-list apply-groups {
                        type leafref {
                            path "../../../../../../groups/group/name";
                        }
                        max-elements 8;
                        ordered-by user;
                        description "Apply a configuration group at this level";
                    }

                    ///nokia-conf/configure/system/security/user-params/local-user/password/apply-groups-exclude
                    leaf-list apply-groups-exclude {
                        type leafref {
                            path "../../../../../../groups/group/name";
                        }
                        max-elements 8;
                        ordered-by user;
                        description "Exclude a configuration group at this level";
                    }

                    ///nokia-conf/configure/system/security/user-params/local-user/password/complexity-rules
                    container complexity-rules {
                        description "Enter the complexity-rules context";

                        ///nokia-conf/configure/system/security/user-params/local-user/password/complexity-rules/allow-user-name
                        leaf allow-user-name {
                            type boolean;
                            default "false";
                            description "Allow the username to be used as part of the password";
                        }

                        ///nokia-conf/configure/system/security/user-params/local-user/password/complexity-rules/minimum-classes
                        leaf minimum-classes {
                            type uint32 {
                                range "2..4";
                            }
                            description "Minimum number of different character classes to use";
                        }

                        ///nokia-conf/configure/system/security/user-params/local-user/password/complexity-rules/minimum-length
                        leaf minimum-length {
                            type uint32 {
                                range "6..50";
                            }
                            default "6";
                            description "Minimum length required for local passwords";
                        }

                        ///nokia-conf/configure/system/security/user-params/local-user/password/complexity-rules/repeated-characters
                        leaf repeated-characters {
                            type uint32 {
                                range "2..8";
                            }
                            description "Number of times same character can repeat consecutively";
                        }

                        ///nokia-conf/configure/system/security/user-params/local-user/password/complexity-rules/complexity-rules-type
                        choice complexity-rules-type {
                            ///nokia-conf/configure/system/security/user-params/local-user/password/complexity-rules/complexity-rules-type/credits
                            case credits {

                                ///nokia-conf/configure/system/security/user-params/local-user/password/complexity-rules/complexity-rules-type/credits/credits
                                container credits {
                                    description "Enter the credits context";

                                    ///nokia-conf/configure/system/security/user-params/local-user/password/complexity-rules/complexity-rules-type/credits/credits/lowercase
                                    leaf lowercase {
                                        type uint32 {
                                            range "1..10";
                                        }
                                        description "Maximum credits for the use of lowercase letters";
                                    }

                                    ///nokia-conf/configure/system/security/user-params/local-user/password/complexity-rules/complexity-rules-type/credits/credits/uppercase
                                    leaf uppercase {
                                        type uint32 {
                                            range "1..10";
                                        }
                                        description "Maximum credits for the use of uppercase letters";
                                    }

                                    ///nokia-conf/configure/system/security/user-params/local-user/password/complexity-rules/complexity-rules-type/credits/credits/numeric
                                    leaf numeric {
                                        type uint32 {
                                            range "1..10";
                                        }
                                        description "Maximum credits for the use of numeric characters";
                                    }

                                    ///nokia-conf/configure/system/security/user-params/local-user/password/complexity-rules/complexity-rules-type/credits/credits/special-character
                                    leaf special-character {
                                        type uint32 {
                                            range "1..10";
                                        }
                                        description "Maximum credits for the use of special characters";
                                    }

                                } // container credits

                            }
                            ///nokia-conf/configure/system/security/user-params/local-user/password/complexity-rules/complexity-rules-type/required
                            case required {

                                ///nokia-conf/configure/system/security/user-params/local-user/password/complexity-rules/complexity-rules-type/required/required
                                container required {
                                    description "Enter the required context";

                                    ///nokia-conf/configure/system/security/user-params/local-user/password/complexity-rules/complexity-rules-type/required/required/lowercase
                                    leaf lowercase {
                                        type uint32 {
                                            range "1..10";
                                        }
                                        description "Number of lowercase letters required";
                                    }

                                    ///nokia-conf/configure/system/security/user-params/local-user/password/complexity-rules/complexity-rules-type/required/required/uppercase
                                    leaf uppercase {
                                        type uint32 {
                                            range "1..10";
                                        }
                                        description "Number of uppercase letters required";
                                    }

                                    ///nokia-conf/configure/system/security/user-params/local-user/password/complexity-rules/complexity-rules-type/required/required/numeric
                                    leaf numeric {
                                        type uint32 {
                                            range "1..10";
                                        }
                                        description "Number of numeric characters required";
                                    }

                                    ///nokia-conf/configure/system/security/user-params/local-user/password/complexity-rules/complexity-rules-type/required/required/special-character
                                    leaf special-character {
                                        type uint32 {
                                            range "1..10";
                                        }
                                        description "Number of special characters required";
                                    }

                                } // container required

                            }
                        }
                    } // container complexity-rules

                } // container password

                ///nokia-conf/configure/system/security/user-params/local-user/user
                list user {
                    key "user-name";
                    description "Enter the user list instance";

                    ///nokia-conf/configure/system/security/user-params/local-user/user/user-name
                    leaf user-name {
                        type types-sros:named-item;
                        description "Local user name";
                    }

                    ///nokia-conf/configure/system/security/user-params/local-user/user/home-directory
                    leaf home-directory {
                        type types-sros:local-url;
                        description "Home directory for the user";
                    }

                    ///nokia-conf/configure/system/security/user-params/local-user/user/password
                    leaf password {
                        type types-sros:hashed-leaf {
                            length "3..136";
                        }
                        mandatory true;
                        description "User password for console and FTP access";
                    }

                    ///nokia-conf/configure/system/security/user-params/local-user/user/restricted-to-home
                    leaf restricted-to-home {
                        type boolean;
                        default "false";
                        description "Restrict file access to the home directory of the user";
                    }

                    ///nokia-conf/configure/system/security/user-params/local-user/user/save-when-restricted
                    leaf save-when-restricted {
                        type boolean;
                        default "false";
                        description "Save configurations when the user is restricted to home";
                    }

                    ///nokia-conf/configure/system/security/user-params/local-user/user/cli-engine
                    leaf-list cli-engine {
                        type types-system:cli-engine-type;
                        max-elements 2;
                        ordered-by user;
                        description "User level override for CLI engine access";
                    }

                    ///nokia-conf/configure/system/security/user-params/local-user/user/apply-groups
                    leaf-list apply-groups {
                        type leafref {
                            path "../../../../../../groups/group/name";
                        }
                        max-elements 8;
                        ordered-by user;
                        description "Apply a configuration group at this level";
                    }

                    ///nokia-conf/configure/system/security/user-params/local-user/user/apply-groups-exclude
                    leaf-list apply-groups-exclude {
                        type leafref {
                            path "../../../../../../groups/group/name";
                        }
                        max-elements 8;
                        ordered-by user;
                        description "Exclude a configuration group at this level";
                    }

                    ///nokia-conf/configure/system/security/user-params/local-user/user/access
                    container access {
                        description "Enter the access context";

                        ///nokia-conf/configure/system/security/user-params/local-user/user/access/console
                        leaf console {
                            type boolean;
                            default "false";
                            description "Allow console port, Telnet, and SSH access";
                        }

                        ///nokia-conf/configure/system/security/user-params/local-user/user/access/ftp
                        leaf ftp {
                            type boolean;
                            default "false";
                            description "Allow FTP access";
                        }

                        ///nokia-conf/configure/system/security/user-params/local-user/user/access/snmp
                        leaf snmp {
                            type boolean;
                            default "false";
                            description "Allow SNMP access";
                        }

                        ///nokia-conf/configure/system/security/user-params/local-user/user/access/netconf
                        leaf netconf {
                            type boolean;
                            default "false";
                            description "Allow NETCONF access";
                        }

                        ///nokia-conf/configure/system/security/user-params/local-user/user/access/grpc
                        leaf grpc {
                            type boolean;
                            default "false";
                            description "Allow gRPC access";
                        }

                        ///nokia-conf/configure/system/security/user-params/local-user/user/access/li
                        leaf li {
                            type boolean;
                            default "false";
                            description "Allow access to LI";
                        }

                    } // container access

                    ///nokia-conf/configure/system/security/user-params/local-user/user/console
                    container console {
                        description "Enter the console context";

                        ///nokia-conf/configure/system/security/user-params/local-user/user/console/cannot-change-password
                        leaf cannot-change-password {
                            type boolean;
                            default "false";
                            description "Change password privileges";
                        }

                        ///nokia-conf/configure/system/security/user-params/local-user/user/console/login-exec
                        leaf login-exec {
                            type union {
                                type types-sros:sat-url;
                                type types-sros:cflash-url;
                                type types-sros:ftp-tftp-url {
                                    length "1..180";
                                }
                                type types-sros:filename;
                            }
                            description "File to execute when a user successfully logs in";
                        }

                        ///nokia-conf/configure/system/security/user-params/local-user/user/console/new-password-at-login
                        leaf new-password-at-login {
                            type boolean;
                            default "false";
                            description "Prompt a user to change password at next console login";
                        }

                        ///nokia-conf/configure/system/security/user-params/local-user/user/console/member
                        leaf-list member {
                            type leafref {
                                path "../../../../../aaa/local-profiles/profile/user-profile-name";
                            }
                            max-elements 8;
                            ordered-by user;
                            description "User profiles for this user";
                        }

                    } // container console

                    ///nokia-conf/configure/system/security/user-params/local-user/user/public-keys
                    container public-keys {
                        description "Enter the public-keys context";

                        ///nokia-conf/configure/system/security/user-params/local-user/user/public-keys/ecdsa
                        container ecdsa {
                            description "Enter the ecdsa context";

                            ///nokia-conf/configure/system/security/user-params/local-user/user/public-keys/ecdsa/ecdsa-key
                            list ecdsa-key {
                                key "ecdsa-public-key-id";
                                description "Enter the ecdsa-key list instance";

                                ///nokia-conf/configure/system/security/user-params/local-user/user/public-keys/ecdsa/ecdsa-key/ecdsa-public-key-id
                                leaf ecdsa-public-key-id {
                                    type uint32 {
                                        range "1..32";
                                    }
                                    description "ECDSA public key identifier";
                                }

                                ///nokia-conf/configure/system/security/user-params/local-user/user/public-keys/ecdsa/ecdsa-key/description
                                leaf description {
                                    type types-sros:description;
                                    description "Text description";
                                }

                                ///nokia-conf/configure/system/security/user-params/local-user/user/public-keys/ecdsa/ecdsa-key/key-value
                                leaf key-value {
                                    type types-sros:string-not-all-spaces {
                                        length "1..255";
                                    }
                                    description "ECDSA public key value";
                                }

                                ///nokia-conf/configure/system/security/user-params/local-user/user/public-keys/ecdsa/ecdsa-key/apply-groups
                                leaf-list apply-groups {
                                    type leafref {
                                        path "../../../../../../../../../groups/group/name";
                                    }
                                    max-elements 8;
                                    ordered-by user;
                                    description "Apply a configuration group at this level";
                                }

                                ///nokia-conf/configure/system/security/user-params/local-user/user/public-keys/ecdsa/ecdsa-key/apply-groups-exclude
                                leaf-list apply-groups-exclude {
                                    type leafref {
                                        path "../../../../../../../../../groups/group/name";
                                    }
                                    max-elements 8;
                                    ordered-by user;
                                    description "Exclude a configuration group at this level";
                                }

                            } // list ecdsa-key

                        } // container ecdsa

                        ///nokia-conf/configure/system/security/user-params/local-user/user/public-keys/rsa
                        container rsa {
                            description "Enter the rsa context";

                            ///nokia-conf/configure/system/security/user-params/local-user/user/public-keys/rsa/rsa-key
                            list rsa-key {
                                key "rsa-public-key-id";
                                description "Enter the rsa-key list instance";

                                ///nokia-conf/configure/system/security/user-params/local-user/user/public-keys/rsa/rsa-key/rsa-public-key-id
                                leaf rsa-public-key-id {
                                    type uint32 {
                                        range "1..32";
                                    }
                                    description "RSA public key identifier";
                                }

                                ///nokia-conf/configure/system/security/user-params/local-user/user/public-keys/rsa/rsa-key/description
                                leaf description {
                                    type types-sros:description;
                                    description "Text description";
                                }

                                ///nokia-conf/configure/system/security/user-params/local-user/user/public-keys/rsa/rsa-key/key-value
                                leaf key-value {
                                    type types-sros:string-not-all-spaces {
                                        length "1..800";
                                    }
                                    description "RSA public key value";
                                }

                                ///nokia-conf/configure/system/security/user-params/local-user/user/public-keys/rsa/rsa-key/apply-groups
                                leaf-list apply-groups {
                                    type leafref {
                                        path "../../../../../../../../../groups/group/name";
                                    }
                                    max-elements 8;
                                    ordered-by user;
                                    description "Apply a configuration group at this level";
                                }

                                ///nokia-conf/configure/system/security/user-params/local-user/user/public-keys/rsa/rsa-key/apply-groups-exclude
                                leaf-list apply-groups-exclude {
                                    type leafref {
                                        path "../../../../../../../../../groups/group/name";
                                    }
                                    max-elements 8;
                                    ordered-by user;
                                    description "Exclude a configuration group at this level";
                                }

                            } // list rsa-key

                        } // container rsa

                    } // container public-keys

                    ///nokia-conf/configure/system/security/user-params/local-user/user/snmp
                    container snmp {
                        description "Enable the snmp context";

                        ///nokia-conf/configure/system/security/user-params/local-user/user/snmp/group
                        leaf group {
                            type types-sros:named-item;
                            description "User to associate with a group name";
                        }

                        ///nokia-conf/configure/system/security/user-params/local-user/user/snmp/apply-groups
                        leaf-list apply-groups {
                            type leafref {
                                path "../../../../../../../groups/group/name";
                            }
                            max-elements 8;
                            ordered-by user;
                            description "Apply a configuration group at this level";
                        }

                        ///nokia-conf/configure/system/security/user-params/local-user/user/snmp/apply-groups-exclude
                        leaf-list apply-groups-exclude {
                            type leafref {
                                path "../../../../../../../groups/group/name";
                            }
                            max-elements 8;
                            ordered-by user;
                            description "Exclude a configuration group at this level";
                        }

                        ///nokia-conf/configure/system/security/user-params/local-user/user/snmp/authentication
                        container authentication {
                            presence "Enable the authentication context";
                            description "Enable the authentication context";

                            ///nokia-conf/configure/system/security/user-params/local-user/user/snmp/authentication/authentication-protocol
                            leaf authentication-protocol {
                                type enumeration {
                                    enum hmac-md5-96                    { value 2; }
                                    enum hmac-sha1-96                   { value 3; }
                                    enum hmac-sha2-224                  { value 4; }
                                    enum hmac-sha2-256                  { value 5; }
                                    enum hmac-sha2-384                  { value 6; }
                                    enum hmac-sha2-512                  { value 7; }
                                    enum md5                            { status obsolete; }
                                    enum sha                            { status obsolete; }
                                }
                                description "Authentication protocol";
                            }

                            ///nokia-conf/configure/system/security/user-params/local-user/user/snmp/authentication/authentication-key
                            leaf authentication-key {
                                type types-sros:encrypted-leaf-hex-without-prefix {
                                    length "1..115";
                                }
                                description "Localized authentication key";
                            }

                            ///nokia-conf/configure/system/security/user-params/local-user/user/snmp/authentication/privacy
                            container privacy {
                                presence "Enable the privacy context";
                                description "Enable the privacy context";

                                ///nokia-conf/configure/system/security/user-params/local-user/user/snmp/authentication/privacy/privacy-protocol
                                leaf privacy-protocol {
                                    type enumeration {
                                        enum cbc-des                        { value 2; }
                                        enum cfb128-aes-128                 { value 4; }
                                        enum cfb128-aes-192                 { value 5; }
                                        enum cfb128-aes-256                 { value 6; }
                                        enum des                            { status obsolete; }
                                        enum aes-128-cfb                    { status obsolete; }
                                    }
                                    mandatory true;
                                    description "Privacy protocol";
                                }

                                ///nokia-conf/configure/system/security/user-params/local-user/user/snmp/authentication/privacy/privacy-key
                                leaf privacy-key {
                                    type types-sros:encrypted-leaf-hex-without-prefix {
                                        length "1..71";
                                    }
                                    mandatory true;
                                    description "Localized privacy key";
                                }

                            } // container privacy

                        } // container authentication

                    } // container snmp

                    ///nokia-conf/configure/system/security/user-params/local-user/user/ssh-authentication-method
                    container ssh-authentication-method {
                        description "Enter the ssh-authentication-method context";


                        ///nokia-conf/configure/system/security/user-params/local-user/user/ssh-authentication-method/server
                        container server {
                            description "Enter the server context";

                            ///nokia-conf/configure/system/security/user-params/local-user/user/ssh-authentication-method/server/public-key-only
                            leaf public-key-only {
                                type types-sros:bool-with-inherit;
                                description "Public key only SSH authentication for this user";
                            }

                        } // container server

                    } // container ssh-authentication-method

                } // list user

            } // container local-user

        } // container user-params

    } // grouping conf-system-security-user-parameters-user-params

}
