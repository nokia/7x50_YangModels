submodule nokia-conf-system-security-aaa {

    yang-version "1.1";

    belongs-to nokia-conf { prefix "conf"; }

    import nokia-sros-yang-extensions     { prefix "sros-ext"; }
    import nokia-types-qos                { prefix "types-qos"; }
    import nokia-types-security           { prefix "types-security"; }
    import nokia-types-sros               { prefix "types-sros"; }
    import nokia-types-system             { prefix "types-system"; }

    include nokia-conf-groups;
    include nokia-conf-service;
    include nokia-conf-svc-vprn;
    include nokia-conf-system;
    include nokia-conf-system-security;
    include nokia-conf-system-security-tls;

    sros-ext:sros-major-release "rel23";
    organization "Nokia";
    contact
        "Nokia SR OS Support
         Web: <http://www.nokia.com>";
    description
        "Nokia YANG Data model to configure system security aaa parameters. on SR OS based routers.

         Copyright 2016 Nokia. All rights reserved. Reproduction of this document
         is authorized on the condition that the foregoing copyright notice is included.

         This nokia-conf-system-security-aaa YANG module embodies Nokia's proprietary
         intellectual property. Nokia retains all title and ownership in the
         specification, including any revisions.

         Nokia grants all interested parties a non-exclusive license to use
         and distribute an unmodified copy of this specification in connection with
         management of Nokia products, and without fee, provided this
         copyright notice and license appear on all copies.

         This specification is supplied `as is', and Nokia makes no warranty,
         either express or implied, as to the use, operation, condition, or performance
         of the specification.";
    revision "2022-08-25";

    grouping conf-system-security-aaa {
        ///nokia-conf/configure/system/security/aaa
        container aaa {
            description "Enable the aaa context";

            ///nokia-conf/configure/system/security/aaa/health-check
            leaf health-check {
                type union {
                    type int32 {
                        range "6..1500";
                    }
                    type enumeration {
                        enum none                           { value 0; }
                    }
                }
                units "seconds";
                default "30";
                description "Polling interval of RADIUS, TACACS+, and LDAP servers";
            }

            ///nokia-conf/configure/system/security/aaa/apply-groups
            leaf-list apply-groups {
                type leafref {
                    path "../../../../groups/group/name";
                }
                max-elements 8;
                ordered-by user;
                description "Apply a configuration group at this level";
            }

            ///nokia-conf/configure/system/security/aaa/apply-groups-exclude
            leaf-list apply-groups-exclude {
                type leafref {
                    path "../../../../groups/group/name";
                }
                max-elements 8;
                ordered-by user;
                description "Exclude a configuration group at this level";
            }

            ///nokia-conf/configure/system/security/aaa/remote-servers
            container remote-servers {
                description "Enable the remote-servers context";

                ///nokia-conf/configure/system/security/aaa/remote-servers/apply-groups
                leaf-list apply-groups {
                    type leafref {
                        path "../../../../../groups/group/name";
                    }
                    max-elements 8;
                    ordered-by user;
                    description "Apply a configuration group at this level";
                }

                ///nokia-conf/configure/system/security/aaa/remote-servers/apply-groups-exclude
                leaf-list apply-groups-exclude {
                    type leafref {
                        path "../../../../../groups/group/name";
                    }
                    max-elements 8;
                    ordered-by user;
                    description "Exclude a configuration group at this level";
                }

                ///nokia-conf/configure/system/security/aaa/remote-servers/radius
                container radius {
                    description "Enter the radius context";

                    ///nokia-conf/configure/system/security/aaa/remote-servers/radius/admin-state
                    leaf admin-state {
                        type types-sros:admin-state;
                        default "enable";
                        description "Administrative state of the authentication server";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/radius/accounting
                    leaf accounting {
                        type boolean;
                        default "false";
                        description "Enable RADIUS command accounting";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/radius/accounting-port
                    leaf accounting-port {
                        type uint32 {
                            range "1..65535";
                        }
                        default "1813";
                        description "Port number on RADIUS server for accounting requests";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/radius/authorization
                    leaf authorization {
                        type boolean;
                        default "false";
                        description "Enable RADIUS authorization";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/radius/interactive-authentication
                    leaf interactive-authentication {
                        type boolean;
                        default "false";
                        description "Enable RADIUS interactive authentication";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/radius/server-retry
                    leaf server-retry {
                        type uint32 {
                            range "1..10";
                        }
                        default "3";
                        description "Number of attempts to retry contacting RADIUS server";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/radius/server-timeout
                    leaf server-timeout {
                        type uint32 {
                            range "1..90";
                        }
                        units "seconds";
                        default "3";
                        description "Time to wait for a response from the RADIUS server";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/radius/port
                    leaf port {
                        type uint32 {
                            range "1..65535";
                        }
                        default "1812";
                        description "UDP port number on which to contact RADIUS server";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/radius/use-default-template
                    leaf use-default-template {
                        type boolean;
                        default "false";
                        description "Apply the RADIUS default user template to RADIUS user";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/radius/access-algorithm
                    leaf access-algorithm {
                        type enumeration {
                            enum direct                         { value 1; }
                            enum round-robin                    { value 2; }
                        }
                        default "direct";
                        description "Algorithm used to access the set of RADIUS servers";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/radius/route-preference
                    leaf route-preference {
                        type types-security:aaa-route-preference;
                        default "both";
                        description "Route preference to reach the AAA server";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/radius/apply-groups
                    leaf-list apply-groups {
                        type leafref {
                            path "../../../../../../groups/group/name";
                        }
                        max-elements 8;
                        ordered-by user;
                        description "Apply a configuration group at this level";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/radius/apply-groups-exclude
                    leaf-list apply-groups-exclude {
                        type leafref {
                            path "../../../../../../groups/group/name";
                        }
                        max-elements 8;
                        ordered-by user;
                        description "Exclude a configuration group at this level";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/radius/server
                    list server {
                        key "index";
                        max-elements 5;
                        description "Enter the server list instance";

                        ///nokia-conf/configure/system/security/aaa/remote-servers/radius/server/index
                        leaf index {
                            type uint32 {
                                range "1..5";
                            }
                            description "RADIUS server ID";
                        }

                        ///nokia-conf/configure/system/security/aaa/remote-servers/radius/server/address
                        leaf address {
                            type types-sros:ip-unicast-address;
                            mandatory true;
                            description "IP address of the RADIUS server";
                        }

                        ///nokia-conf/configure/system/security/aaa/remote-servers/radius/server/authenticator
                        leaf authenticator {
                            type enumeration {
                                enum md5                            { value 1; }
                                enum sm3                            { value 2; }
                            }
                            default "md5";
                            description "Authenticator hash algorithm for the RADIUS server";
                        }

                        ///nokia-conf/configure/system/security/aaa/remote-servers/radius/server/secret
                        leaf secret {
                            type types-sros:encrypted-leaf {
                                length "1..115";
                            }
                            description "Secret key to access the RADIUS server";
                        }

                        ///nokia-conf/configure/system/security/aaa/remote-servers/radius/server/tls-client-profile
                        leaf tls-client-profile {
                            type leafref {
                                path "../../../../../tls/client-tls-profile/client-profile-name";
                            }
                            description "TLS client profile for the RADIUS server";
                        }

                        ///nokia-conf/configure/system/security/aaa/remote-servers/radius/server/apply-groups
                        leaf-list apply-groups {
                            type leafref {
                                path "../../../../../../../groups/group/name";
                            }
                            max-elements 8;
                            ordered-by user;
                            description "Apply a configuration group at this level";
                        }

                        ///nokia-conf/configure/system/security/aaa/remote-servers/radius/server/apply-groups-exclude
                        leaf-list apply-groups-exclude {
                            type leafref {
                                path "../../../../../../../groups/group/name";
                            }
                            max-elements 8;
                            ordered-by user;
                            description "Exclude a configuration group at this level";
                        }

                    } // list server

                } // container radius

                ///nokia-conf/configure/system/security/aaa/remote-servers/ldap
                container ldap {
                    description "Enter the ldap context";

                    ///nokia-conf/configure/system/security/aaa/remote-servers/ldap/admin-state
                    leaf admin-state {
                        type types-sros:admin-state;
                        default "enable";
                        description "Administrative state of the LDAP operation protocol";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/ldap/public-key-authentication
                    leaf public-key-authentication {
                        type boolean;
                        default "false";
                        description "Allow SSH public key authentication from LDAP server";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/ldap/server-retry
                    leaf server-retry {
                        type uint32 {
                            range "1..10";
                        }
                        default "3";
                        description "Number of attempts to retry contacting the LDAP server";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/ldap/server-timeout
                    leaf server-timeout {
                        type types-sros:time-duration {
                            range "1..90";
                        }
                        units "seconds";
                        default "3";
                        description "Timeout for a response from the LDAP server";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/ldap/use-default-template
                    leaf use-default-template {
                        type boolean;
                        default "true";
                        description "Apply the default template to LDAP";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/ldap/route-preference
                    leaf route-preference {
                        type types-security:aaa-route-preference;
                        default "both";
                        description "Route preference to reach the AAA server";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/ldap/apply-groups
                    leaf-list apply-groups {
                        type leafref {
                            path "../../../../../../groups/group/name";
                        }
                        max-elements 8;
                        ordered-by user;
                        description "Apply a configuration group at this level";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/ldap/apply-groups-exclude
                    leaf-list apply-groups-exclude {
                        type leafref {
                            path "../../../../../../groups/group/name";
                        }
                        max-elements 8;
                        ordered-by user;
                        description "Exclude a configuration group at this level";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/ldap/server
                    list server {
                        key "index";
                        max-elements 5;
                        description "Enter the server list instance";

                        ///nokia-conf/configure/system/security/aaa/remote-servers/ldap/server/index
                        leaf index {
                            type uint32 {
                                range "1..5";
                            }
                            description "LDAP server ID";
                        }

                        ///nokia-conf/configure/system/security/aaa/remote-servers/ldap/server/admin-state
                        leaf admin-state {
                            type types-sros:admin-state;
                            default "disable";
                            description "Administrative state of the LDAP server";
                        }

                        ///nokia-conf/configure/system/security/aaa/remote-servers/ldap/server/server-name
                        leaf server-name {
                            type types-sros:named-item;
                            description "LDAP server name";
                        }

                        ///nokia-conf/configure/system/security/aaa/remote-servers/ldap/server/tls-profile
                        leaf tls-profile {
                            type leafref {
                                path "../../../../../tls/client-tls-profile/client-profile-name";
                            }
                            description "TLS client profile used to encrypt the LDAP connection";
                        }

                        ///nokia-conf/configure/system/security/aaa/remote-servers/ldap/server/apply-groups
                        leaf-list apply-groups {
                            type leafref {
                                path "../../../../../../../groups/group/name";
                            }
                            max-elements 8;
                            ordered-by user;
                            description "Apply a configuration group at this level";
                        }

                        ///nokia-conf/configure/system/security/aaa/remote-servers/ldap/server/apply-groups-exclude
                        leaf-list apply-groups-exclude {
                            type leafref {
                                path "../../../../../../../groups/group/name";
                            }
                            max-elements 8;
                            ordered-by user;
                            description "Exclude a configuration group at this level";
                        }

                        ///nokia-conf/configure/system/security/aaa/remote-servers/ldap/server/address
                        list address {
                            key "ip-address";
                            max-elements 1;
                            description "Enter the address list instance";

                            ///nokia-conf/configure/system/security/aaa/remote-servers/ldap/server/address/ip-address
                            leaf ip-address {
                                type types-sros:ip-unicast-address;
                                description "LDAP server address";
                            }

                            ///nokia-conf/configure/system/security/aaa/remote-servers/ldap/server/address/port
                            leaf port {
                                type int32 {
                                    range "1..65535";
                                }
                                default "389";
                                description "Port number on which to contact the LDAP server";
                            }

                            ///nokia-conf/configure/system/security/aaa/remote-servers/ldap/server/address/apply-groups
                            leaf-list apply-groups {
                                type leafref {
                                    path "../../../../../../../../groups/group/name";
                                }
                                max-elements 8;
                                ordered-by user;
                                description "Apply a configuration group at this level";
                            }

                            ///nokia-conf/configure/system/security/aaa/remote-servers/ldap/server/address/apply-groups-exclude
                            leaf-list apply-groups-exclude {
                                type leafref {
                                    path "../../../../../../../../groups/group/name";
                                }
                                max-elements 8;
                                ordered-by user;
                                description "Exclude a configuration group at this level";
                            }

                        } // list address

                        ///nokia-conf/configure/system/security/aaa/remote-servers/ldap/server/bind-authentication
                        container bind-authentication {
                            description "Enter the bind-authentication context";

                            ///nokia-conf/configure/system/security/aaa/remote-servers/ldap/server/bind-authentication/root-dn
                            leaf root-dn {
                                type types-sros:string-not-all-spaces {
                                    length "1..512";
                                }
                                description "Root domain used for authentication with LDAP server";
                            }

                            ///nokia-conf/configure/system/security/aaa/remote-servers/ldap/server/bind-authentication/password
                            leaf password {
                                type types-sros:encrypted-leaf {
                                    length "1..199";
                                }
                                description "Password used for authentication with the LDAP server";
                            }

                        } // container bind-authentication

                        ///nokia-conf/configure/system/security/aaa/remote-servers/ldap/server/search
                        container search {
                            description "Enter the search context";

                            ///nokia-conf/configure/system/security/aaa/remote-servers/ldap/server/search/base-dn
                            leaf base-dn {
                                type types-sros:string-not-all-spaces {
                                    length "1..512";
                                }
                                description "LDAP server search base domain name";
                            }

                        } // container search

                    } // list server

                } // container ldap

                ///nokia-conf/configure/system/security/aaa/remote-servers/tacplus
                container tacplus {
                    description "Enter the tacplus context";

                    ///nokia-conf/configure/system/security/aaa/remote-servers/tacplus/interactive-authentication
                    leaf interactive-authentication {
                        type boolean;
                        default "false";
                        description "Allows TACACS+ interactive authentication";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/tacplus/admin-state
                    leaf admin-state {
                        type types-sros:admin-state;
                        default "enable";
                        description "Administrative state of the TACACS+ protocol";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/tacplus/server-timeout
                    leaf server-timeout {
                        type types-sros:time-duration {
                            range "1..90";
                        }
                        units "seconds";
                        default "3";
                        description "Time to wait for a response from the TACACS+ server";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/tacplus/use-default-template
                    leaf use-default-template {
                        type boolean;
                        default "true";
                        description "Apply TACACS+ default user-template to TACACS+ user";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/tacplus/route-preference
                    leaf route-preference {
                        type types-security:aaa-route-preference;
                        default "both";
                        description "Route preference to reach the AAA server";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/tacplus/apply-groups
                    leaf-list apply-groups {
                        type leafref {
                            path "../../../../../../groups/group/name";
                        }
                        max-elements 8;
                        ordered-by user;
                        description "Apply a configuration group at this level";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/tacplus/apply-groups-exclude
                    leaf-list apply-groups-exclude {
                        type leafref {
                            path "../../../../../../groups/group/name";
                        }
                        max-elements 8;
                        ordered-by user;
                        description "Exclude a configuration group at this level";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/tacplus/accounting
                    container accounting {
                        presence "Enable the accounting context";
                        description "Enable the accounting context";

                        ///nokia-conf/configure/system/security/aaa/remote-servers/tacplus/accounting/record-type
                        leaf record-type {
                            type enumeration {
                                enum start-stop                     { value 1; }
                                enum stop-only                      { value 2; }
                            }
                            default "stop-only";
                            description "Type of accounting record packet sent to TACACS+ server";
                        }

                    } // container accounting

                    ///nokia-conf/configure/system/security/aaa/remote-servers/tacplus/authorization
                    container authorization {
                        presence "Enable the authorization context";
                        description "Enable the authorization context";

                        ///nokia-conf/configure/system/security/aaa/remote-servers/tacplus/authorization/use-priv-lvl
                        leaf use-priv-lvl {
                            type boolean;
                            default "false";
                            description "Allow privilege level mapping";
                        }

                        ///nokia-conf/configure/system/security/aaa/remote-servers/tacplus/authorization/request-format
                        container request-format {
                            description "Enter the request-format context";

                            ///nokia-conf/configure/system/security/aaa/remote-servers/tacplus/authorization/request-format/access-operation-cmd
                            leaf-list access-operation-cmd {
                                type enumeration {
                                    enum delete                         { value 1; }
                                }
                                max-elements 1;
                                description "Access operations sent in authorization requests";
                            }

                        } // container request-format

                    } // container authorization

                    ///nokia-conf/configure/system/security/aaa/remote-servers/tacplus/admin-control
                    container admin-control {
                        description "Enter the admin-control context";

                        ///nokia-conf/configure/system/security/aaa/remote-servers/tacplus/admin-control/tacplus-map-to-priv-lvl
                        leaf tacplus-map-to-priv-lvl {
                            type int32 {
                                range "0..15";
                            }
                            description "Interactive authentication from node to TACACS+ server";
                        }

                    } // container admin-control

                    ///nokia-conf/configure/system/security/aaa/remote-servers/tacplus/priv-lvl-map
                    container priv-lvl-map {
                        description "Enable the priv-lvl-map context";

                        ///nokia-conf/configure/system/security/aaa/remote-servers/tacplus/priv-lvl-map/apply-groups
                        leaf-list apply-groups {
                            type leafref {
                                path "../../../../../../../groups/group/name";
                            }
                            max-elements 8;
                            ordered-by user;
                            description "Apply a configuration group at this level";
                        }

                        ///nokia-conf/configure/system/security/aaa/remote-servers/tacplus/priv-lvl-map/apply-groups-exclude
                        leaf-list apply-groups-exclude {
                            type leafref {
                                path "../../../../../../../groups/group/name";
                            }
                            max-elements 8;
                            ordered-by user;
                            description "Exclude a configuration group at this level";
                        }

                        ///nokia-conf/configure/system/security/aaa/remote-servers/tacplus/priv-lvl-map/priv-lvl
                        list priv-lvl {
                            key "level";
                            description "Enter the priv-lvl list instance";

                            ///nokia-conf/configure/system/security/aaa/remote-servers/tacplus/priv-lvl-map/priv-lvl/level
                            leaf level {
                                type uint32 {
                                    range "0..15";
                                }
                                description "Privilege level for the mapping";
                            }

                            ///nokia-conf/configure/system/security/aaa/remote-servers/tacplus/priv-lvl-map/priv-lvl/user-profile-name
                            leaf user-profile-name {
                                type leafref {
                                    path "../../../../../local-profiles/profile/user-profile-name";
                                }
                                mandatory true;
                                description "User profile for the mapping";
                            }

                            ///nokia-conf/configure/system/security/aaa/remote-servers/tacplus/priv-lvl-map/priv-lvl/apply-groups
                            leaf-list apply-groups {
                                type leafref {
                                    path "../../../../../../../../groups/group/name";
                                }
                                max-elements 8;
                                ordered-by user;
                                description "Apply a configuration group at this level";
                            }

                            ///nokia-conf/configure/system/security/aaa/remote-servers/tacplus/priv-lvl-map/priv-lvl/apply-groups-exclude
                            leaf-list apply-groups-exclude {
                                type leafref {
                                    path "../../../../../../../../groups/group/name";
                                }
                                max-elements 8;
                                ordered-by user;
                                description "Exclude a configuration group at this level";
                            }

                        } // list priv-lvl

                    } // container priv-lvl-map

                    ///nokia-conf/configure/system/security/aaa/remote-servers/tacplus/server
                    list server {
                        key "index";
                        max-elements 5;
                        description "Enter the server list instance";

                        ///nokia-conf/configure/system/security/aaa/remote-servers/tacplus/server/index
                        leaf index {
                            type uint32 {
                                range "1..5";
                            }
                            description "TACACS+ server ID";
                        }

                        ///nokia-conf/configure/system/security/aaa/remote-servers/tacplus/server/address
                        leaf address {
                            type types-sros:ip-unicast-address;
                            mandatory true;
                            description "IP address of the TACACS+ server";
                        }

                        ///nokia-conf/configure/system/security/aaa/remote-servers/tacplus/server/port
                        leaf port {
                            type types-qos:tcp-udp-match-port;
                            default "49";
                            description "TCP port ID on which to contact TACACS+ server";
                        }

                        ///nokia-conf/configure/system/security/aaa/remote-servers/tacplus/server/secret
                        leaf secret {
                            type types-sros:encrypted-leaf {
                                length "1..199";
                            }
                            mandatory true;
                            description "Secret key to access the TACACS+ server";
                        }

                        ///nokia-conf/configure/system/security/aaa/remote-servers/tacplus/server/apply-groups
                        leaf-list apply-groups {
                            type leafref {
                                path "../../../../../../../groups/group/name";
                            }
                            max-elements 8;
                            ordered-by user;
                            description "Apply a configuration group at this level";
                        }

                        ///nokia-conf/configure/system/security/aaa/remote-servers/tacplus/server/apply-groups-exclude
                        leaf-list apply-groups-exclude {
                            type leafref {
                                path "../../../../../../../groups/group/name";
                            }
                            max-elements 8;
                            ordered-by user;
                            description "Exclude a configuration group at this level";
                        }

                    } // list server

                } // container tacplus

                ///nokia-conf/configure/system/security/aaa/remote-servers/vprn-server
                container vprn-server {
                    description "Enable the vprn-server context";

                    ///nokia-conf/configure/system/security/aaa/remote-servers/vprn-server/inband
                    leaf inband {
                        type leafref {
                            path "../../../../../../service/vprn/service-name";
                        }
                        description "VPRN service used for AAA by in-band sessions";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/vprn-server/outband
                    leaf outband {
                        type leafref {
                            path "../../../../../../service/vprn/service-name";
                        }
                        description "VPRN service used for AAA by out-of-band sessions";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/vprn-server/vprn
                    leaf vprn {
                        type leafref {
                            path "../../../../../../service/vprn/service-name";
                        }
                        description "VPRN used for AAA in VPRNs without a AAA server";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/vprn-server/apply-groups
                    leaf-list apply-groups {
                        type leafref {
                            path "../../../../../../groups/group/name";
                        }
                        max-elements 8;
                        ordered-by user;
                        description "Apply a configuration group at this level";
                    }

                    ///nokia-conf/configure/system/security/aaa/remote-servers/vprn-server/apply-groups-exclude
                    leaf-list apply-groups-exclude {
                        type leafref {
                            path "../../../../../../groups/group/name";
                        }
                        max-elements 8;
                        ordered-by user;
                        description "Exclude a configuration group at this level";
                    }

                } // container vprn-server

            } // container remote-servers

            ///nokia-conf/configure/system/security/aaa/local-profiles
            container local-profiles {
                description "Enter the local-profiles context";

                ///nokia-conf/configure/system/security/aaa/local-profiles/apply-groups
                leaf-list apply-groups {
                    type leafref {
                        path "../../../../../groups/group/name";
                    }
                    max-elements 8;
                    ordered-by user;
                    description "Apply a configuration group at this level";
                }

                ///nokia-conf/configure/system/security/aaa/local-profiles/apply-groups-exclude
                leaf-list apply-groups-exclude {
                    type leafref {
                        path "../../../../../groups/group/name";
                    }
                    max-elements 8;
                    ordered-by user;
                    description "Exclude a configuration group at this level";
                }

                ///nokia-conf/configure/system/security/aaa/local-profiles/profile
                list profile {
                    key "user-profile-name";
                    max-elements 128;
                    description "Enter the profile list instance";

                    ///nokia-conf/configure/system/security/aaa/local-profiles/profile/user-profile-name
                    leaf user-profile-name {
                        type types-sros:named-item {
                            pattern "[^ ]*" {
                                error-message "The name cannot contain spaces.";
                            }
                        }
                        description "User profile name";
                    }

                    ///nokia-conf/configure/system/security/aaa/local-profiles/profile/cli-session-group
                    leaf cli-session-group {
                        type leafref {
                            path "../../../cli-session-group/cli-session-group-name";
                        }
                        description "CLI session group to which the profile belongs";
                    }

                    ///nokia-conf/configure/system/security/aaa/local-profiles/profile/combined-max-sessions
                    leaf combined-max-sessions {
                        type types-system:session-limit;
                        description "Maximum number of concurrent SSH and Telnet sessions";
                    }

                    ///nokia-conf/configure/system/security/aaa/local-profiles/profile/ssh-max-sessions
                    leaf ssh-max-sessions {
                        type types-system:session-limit;
                        description "Maximum number of concurrent SSH sessions";
                    }

                    ///nokia-conf/configure/system/security/aaa/local-profiles/profile/telnet-max-sessions
                    leaf telnet-max-sessions {
                        type types-system:session-limit;
                        description "Maximum number of concurrent Telnet sessions";
                    }

                    ///nokia-conf/configure/system/security/aaa/local-profiles/profile/li
                    leaf li {
                        type boolean;
                        default "false";
                        description "Allow lawful intercept profile ID";
                    }

                    ///nokia-conf/configure/system/security/aaa/local-profiles/profile/default-action
                    leaf default-action {
                        type enumeration {
                            enum deny-all                       { value 1; }
                            enum permit-all                     { value 2; }
                            enum none                           { value 3; }
                            enum read-only-all                  { value 4; }
                        }
                        default "none";
                        description "Action for non-matching entry";
                    }

                    ///nokia-conf/configure/system/security/aaa/local-profiles/profile/apply-groups
                    leaf-list apply-groups {
                        type leafref {
                            path "../../../../../../groups/group/name";
                        }
                        max-elements 8;
                        ordered-by user;
                        description "Apply a configuration group at this level";
                    }

                    ///nokia-conf/configure/system/security/aaa/local-profiles/profile/apply-groups-exclude
                    leaf-list apply-groups-exclude {
                        type leafref {
                            path "../../../../../../groups/group/name";
                        }
                        max-elements 8;
                        ordered-by user;
                        description "Exclude a configuration group at this level";
                    }

                    ///nokia-conf/configure/system/security/aaa/local-profiles/profile/entry
                    list entry {
                        key "entry-id";
                        description "Enter the entry list instance";

                        ///nokia-conf/configure/system/security/aaa/local-profiles/profile/entry/entry-id
                        leaf entry-id {
                            type uint32 {
                                range "1..9999";
                            }
                            description "User profile entry ID";
                        }

                        ///nokia-conf/configure/system/security/aaa/local-profiles/profile/entry/description
                        leaf description {
                            type types-sros:description;
                            description "Text description";
                        }

                        ///nokia-conf/configure/system/security/aaa/local-profiles/profile/entry/match
                        leaf match {
                            type types-sros:display-string;
                            description "Command to match the entry";
                        }

                        ///nokia-conf/configure/system/security/aaa/local-profiles/profile/entry/action
                        leaf action {
                            type enumeration {
                                enum deny                           { value 1; }
                                enum permit                         { value 2; }
                                enum none                           { value 3; }
                                enum read-only                      { value 4; }
                            }
                            default "none";
                            description "Action when a user command matches the entry";
                        }

                        ///nokia-conf/configure/system/security/aaa/local-profiles/profile/entry/apply-groups
                        leaf-list apply-groups {
                            type leafref {
                                path "../../../../../../../groups/group/name";
                            }
                            max-elements 8;
                            ordered-by user;
                            description "Apply a configuration group at this level";
                        }

                        ///nokia-conf/configure/system/security/aaa/local-profiles/profile/entry/apply-groups-exclude
                        leaf-list apply-groups-exclude {
                            type leafref {
                                path "../../../../../../../groups/group/name";
                            }
                            max-elements 8;
                            ordered-by user;
                            description "Exclude a configuration group at this level";
                        }

                    } // list entry

                    ///nokia-conf/configure/system/security/aaa/local-profiles/profile/grpc
                    container grpc {
                        description "Enter the grpc context";

                        ///nokia-conf/configure/system/security/aaa/local-profiles/profile/grpc/rpc-authorization
                        container rpc-authorization {
                            description "Enter the rpc-authorization context";

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/grpc/rpc-authorization/gnmi-capabilities
                            leaf gnmi-capabilities {
                                type types-system:permit-deny;
                                description "gNMI Capabilities RPC authorization";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/grpc/rpc-authorization/gnmi-get
                            leaf gnmi-get {
                                type types-system:permit-deny;
                                description "gNMI Get RPC authorization";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/grpc/rpc-authorization/gnmi-set
                            leaf gnmi-set {
                                type types-system:permit-deny;
                                description "gNMI Set RPC authorization";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/grpc/rpc-authorization/gnmi-subscribe
                            leaf gnmi-subscribe {
                                type types-system:permit-deny;
                                description "gNMI Subscribe RPC authorization";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/grpc/rpc-authorization/gnoi-cert-mgmt-rotate
                            leaf gnoi-cert-mgmt-rotate {
                                type types-system:permit-deny;
                                default "deny";
                                description "gNOI Rotate RPC authorization";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/grpc/rpc-authorization/gnoi-cert-mgmt-install
                            leaf gnoi-cert-mgmt-install {
                                type types-system:permit-deny;
                                default "deny";
                                description "gNOI Install RPC authorization";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/grpc/rpc-authorization/gnoi-cert-mgmt-getcert
                            leaf gnoi-cert-mgmt-getcert {
                                type types-system:permit-deny;
                                default "deny";
                                description "gNOI GetCertificates RPC authorization";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/grpc/rpc-authorization/gnoi-cert-mgmt-revoke
                            leaf gnoi-cert-mgmt-revoke {
                                type types-system:permit-deny;
                                default "deny";
                                description "gNOI RevokeCertificates RPC authorization";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/grpc/rpc-authorization/gnoi-cert-mgmt-cangenerate
                            leaf gnoi-cert-mgmt-cangenerate {
                                type types-system:permit-deny;
                                default "deny";
                                description "gNOI CanGenerateCSR RPC authorization";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/grpc/rpc-authorization/gnoi-file-get
                            leaf gnoi-file-get {
                                type types-system:permit-deny;
                                description "gNOI File Get RPC authorization";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/grpc/rpc-authorization/gnoi-file-transfertoremote
                            leaf gnoi-file-transfertoremote {
                                type types-system:permit-deny;
                                description "gNOI File TransferToRemote RPC authorization";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/grpc/rpc-authorization/gnoi-file-put
                            leaf gnoi-file-put {
                                type types-system:permit-deny;
                                description "gNOI File Put RPC authorization";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/grpc/rpc-authorization/gnoi-file-stat
                            leaf gnoi-file-stat {
                                type types-system:permit-deny;
                                description "gNOI File Stat RPC authorization";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/grpc/rpc-authorization/gnoi-file-remove
                            leaf gnoi-file-remove {
                                type types-system:permit-deny;
                                description "gNOI File Remove RPC authorization";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/grpc/rpc-authorization/gnoi-system-ping
                            leaf gnoi-system-ping {
                                type types-system:permit-deny;
                                description "gNOI System Ping RPC authorization";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/grpc/rpc-authorization/gnoi-system-traceroute
                            leaf gnoi-system-traceroute {
                                type types-system:permit-deny;
                                description "gNOI System Traceroute RPC authorization";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/grpc/rpc-authorization/gnoi-system-time
                            leaf gnoi-system-time {
                                type types-system:permit-deny;
                                description "gNOI System Time RPC authorization";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/grpc/rpc-authorization/gnoi-system-setpackage
                            leaf gnoi-system-setpackage {
                                type types-system:permit-deny;
                                default "deny";
                                description "gNOI System SetPackage RPC authorization";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/grpc/rpc-authorization/gnoi-system-switchcontrolprocessor
                            leaf gnoi-system-switchcontrolprocessor {
                                type types-system:permit-deny;
                                default "deny";
                                description "gNOI System SwitchControlProcessor RPC authorization";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/grpc/rpc-authorization/gnoi-system-reboot
                            leaf gnoi-system-reboot {
                                type types-system:permit-deny;
                                default "deny";
                                description "gNOI System Reboot RPC authorization";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/grpc/rpc-authorization/gnoi-system-rebootstatus
                            leaf gnoi-system-rebootstatus {
                                type types-system:permit-deny;
                                default "deny";
                                description "gNOI System RebootStatus RPC authorization";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/grpc/rpc-authorization/gnoi-system-cancelreboot
                            leaf gnoi-system-cancelreboot {
                                type types-system:permit-deny;
                                default "deny";
                                description "gNOI System CancelReboot RPC authorization";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/grpc/rpc-authorization/md-cli-session
                            leaf md-cli-session {
                                type types-system:permit-deny;
                                description "gNOI MdCli Session RPC authorization";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/grpc/rpc-authorization/rib-api-getversion
                            leaf rib-api-getversion {
                                type types-system:permit-deny;
                                description "RibApi GetVersion RPC authorization";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/grpc/rpc-authorization/rib-api-modify
                            leaf rib-api-modify {
                                type types-system:permit-deny;
                                description "RibApi Modify RPC authorization";
                            }

                        } // container rpc-authorization

                    } // container grpc

                    ///nokia-conf/configure/system/security/aaa/local-profiles/profile/netconf
                    container netconf {
                        description "Enter the netconf context";

                        ///nokia-conf/configure/system/security/aaa/local-profiles/profile/netconf/base-op-authorization
                        container base-op-authorization {
                            description "Enter the base-op-authorization context";

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/netconf/base-op-authorization/action
                            leaf action {
                                type boolean;
                                default "false";
                                description "Allow NETCONF action operation";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/netconf/base-op-authorization/cancel-commit
                            leaf cancel-commit {
                                type boolean;
                                default "false";
                                description "Allow NETCONF cancel-commit operation";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/netconf/base-op-authorization/close-session
                            leaf close-session {
                                type boolean;
                                default "false";
                                description "Allow NETCONF close-session operation";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/netconf/base-op-authorization/commit
                            leaf commit {
                                type boolean;
                                default "false";
                                description "Allow NETCONF commit operation";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/netconf/base-op-authorization/copy-config
                            leaf copy-config {
                                type boolean;
                                default "false";
                                description "Allow NETCONF copy-config operation";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/netconf/base-op-authorization/create-subscription
                            leaf create-subscription {
                                type boolean;
                                default "false";
                                description "Allow NETCONF create-subscription operation";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/netconf/base-op-authorization/delete-config
                            leaf delete-config {
                                type boolean;
                                default "false";
                                description "Allow NETCONF delete-config operation";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/netconf/base-op-authorization/discard-changes
                            leaf discard-changes {
                                type boolean;
                                default "false";
                                description "Allow NETCONF discard-changes operation";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/netconf/base-op-authorization/edit-config
                            leaf edit-config {
                                type boolean;
                                default "false";
                                description "Allow NETCONF edit-config operation";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/netconf/base-op-authorization/get
                            leaf get {
                                type boolean;
                                default "false";
                                description "Allow NETCONF get operation";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/netconf/base-op-authorization/get-config
                            leaf get-config {
                                type boolean;
                                default "false";
                                description "Allow NETCONF get-config operation";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/netconf/base-op-authorization/get-data
                            leaf get-data {
                                type boolean;
                                default "false";
                                description "Allow NETCONF get-data operation";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/netconf/base-op-authorization/get-schema
                            leaf get-schema {
                                type boolean;
                                default "false";
                                description "Allow NETCONF get-schema operation";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/netconf/base-op-authorization/kill-session
                            leaf kill-session {
                                type boolean;
                                default "false";
                                description "Allow NETCONF kill-session operation";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/netconf/base-op-authorization/lock
                            leaf lock {
                                type boolean;
                                default "false";
                                description "Allow NETCONF lock and unlock operations";
                            }

                            ///nokia-conf/configure/system/security/aaa/local-profiles/profile/netconf/base-op-authorization/validate
                            leaf validate {
                                type boolean;
                                default "false";
                                description "Allow NETCONF validate operation";
                            }

                        } // container base-op-authorization

                    } // container netconf

                } // list profile

            } // container local-profiles

            ///nokia-conf/configure/system/security/aaa/user-template
            list user-template {
                key "user-template-name";
                description "Enter the user-template list instance";

                ///nokia-conf/configure/system/security/aaa/user-template/user-template-name
                leaf user-template-name {
                    type enumeration {
                        enum ldap-default                   { value 0; }
                        enum radius-default                 { value 1; }
                        enum tacplus-default                { value 2; }
                    }
                    description "Default user template applied to the system user";
                }

                ///nokia-conf/configure/system/security/aaa/user-template/home-directory
                leaf home-directory {
                    type types-sros:local-url;
                    description "User local home directory based on the template";
                }

                ///nokia-conf/configure/system/security/aaa/user-template/profile
                leaf profile {
                    type types-sros:named-item {
                        pattern "[^ ]*" {
                            error-message "The profile name cannot contain spaces.";
                        }
                    }
                    description "User profile based on the template";
                }

                ///nokia-conf/configure/system/security/aaa/user-template/restricted-to-home
                leaf restricted-to-home {
                    type boolean;
                    default "false";
                    description "Restrict file access to the home directory of the user";
                }

                ///nokia-conf/configure/system/security/aaa/user-template/save-when-restricted
                leaf save-when-restricted {
                    type boolean;
                    default "false";
                    description "Save configurations when the user is restricted to home";
                }

                ///nokia-conf/configure/system/security/aaa/user-template/apply-groups
                leaf-list apply-groups {
                    type leafref {
                        path "../../../../../groups/group/name";
                    }
                    max-elements 8;
                    ordered-by user;
                    description "Apply a configuration group at this level";
                }

                ///nokia-conf/configure/system/security/aaa/user-template/apply-groups-exclude
                leaf-list apply-groups-exclude {
                    type leafref {
                        path "../../../../../groups/group/name";
                    }
                    max-elements 8;
                    ordered-by user;
                    description "Exclude a configuration group at this level";
                }

                ///nokia-conf/configure/system/security/aaa/user-template/access
                container access {
                    description "Enter the access context";

                    ///nokia-conf/configure/system/security/aaa/user-template/access/ftp
                    leaf ftp {
                        type boolean;
                        default "false";
                        description "Allow FTP access";
                    }

                    ///nokia-conf/configure/system/security/aaa/user-template/access/console
                    leaf console {
                        type boolean;
                        default "true";
                        description "Allow console access (serial port or Telnet)";
                    }

                    ///nokia-conf/configure/system/security/aaa/user-template/access/grpc
                    leaf grpc {
                        type boolean;
                        default "false";
                        description "Allow gRPC access";
                    }

                    ///nokia-conf/configure/system/security/aaa/user-template/access/netconf
                    leaf netconf {
                        type boolean;
                        default "false";
                        description "Allow NETCONF session access";
                    }

                    ///nokia-conf/configure/system/security/aaa/user-template/access/li
                    leaf li {
                        type boolean;
                        default "false";
                        description "Allow access to lawful intercept";
                    }

                } // container access

                ///nokia-conf/configure/system/security/aaa/user-template/console
                container console {
                    description "Enter the console context";

                    ///nokia-conf/configure/system/security/aaa/user-template/console/login-exec
                    leaf login-exec {
                        type types-sros:string-not-all-spaces {
                            length "1..200";
                        }
                        description "File to execute for a successful user login via console";
                    }

                } // container console

            } // list user-template

            ///nokia-conf/configure/system/security/aaa/cli-session-group
            list cli-session-group {
                key "cli-session-group-name";
                max-elements 16;
                description "Enter the cli-session-group list instance";

                ///nokia-conf/configure/system/security/aaa/cli-session-group/cli-session-group-name
                leaf cli-session-group-name {
                    type types-sros:named-item {
                        pattern "[^ ]*" {
                            error-message "The name cannot contain spaces.";
                        }
                    }
                    description "CLI session group name";
                }

                ///nokia-conf/configure/system/security/aaa/cli-session-group/description
                leaf description {
                    type types-sros:description;
                    description "Text description";
                }

                ///nokia-conf/configure/system/security/aaa/cli-session-group/combined-max-sessions
                leaf combined-max-sessions {
                    type types-system:session-limit;
                    description "Maximum number of concurrent SSH and Telnet sessions";
                }

                ///nokia-conf/configure/system/security/aaa/cli-session-group/ssh-max-sessions
                leaf ssh-max-sessions {
                    type types-system:session-limit;
                    description "Maximum number of concurrent SSH sessions";
                }

                ///nokia-conf/configure/system/security/aaa/cli-session-group/telnet-max-sessions
                leaf telnet-max-sessions {
                    type types-system:session-limit;
                    description "Maximum number of concurrent Telnet sessions";
                }

                ///nokia-conf/configure/system/security/aaa/cli-session-group/apply-groups
                leaf-list apply-groups {
                    type leafref {
                        path "../../../../../groups/group/name";
                    }
                    max-elements 8;
                    ordered-by user;
                    description "Apply a configuration group at this level";
                }

                ///nokia-conf/configure/system/security/aaa/cli-session-group/apply-groups-exclude
                leaf-list apply-groups-exclude {
                    type leafref {
                        path "../../../../../groups/group/name";
                    }
                    max-elements 8;
                    ordered-by user;
                    description "Exclude a configuration group at this level";
                }

            } // list cli-session-group

            ///nokia-conf/configure/system/security/aaa/management-interface
            container management-interface {
                description "Enable the management-interface context";

                ///nokia-conf/configure/system/security/aaa/management-interface/apply-groups
                leaf-list apply-groups {
                    type leafref {
                        path "../../../../../groups/group/name";
                    }
                    max-elements 8;
                    ordered-by user;
                    description "Apply a configuration group at this level";
                }

                ///nokia-conf/configure/system/security/aaa/management-interface/apply-groups-exclude
                leaf-list apply-groups-exclude {
                    type leafref {
                        path "../../../../../groups/group/name";
                    }
                    max-elements 8;
                    ordered-by user;
                    description "Exclude a configuration group at this level";
                }

                ///nokia-conf/configure/system/security/aaa/management-interface/output-authorization
                container output-authorization {
                    description "Enter the output-authorization context";

                    ///nokia-conf/configure/system/security/aaa/management-interface/output-authorization/md-interfaces
                    leaf md-interfaces {
                        type boolean;
                        default "true";
                        description "Authorize output in model-driven interfaces";
                    }

                    ///nokia-conf/configure/system/security/aaa/management-interface/output-authorization/telemetry-data
                    leaf telemetry-data {
                        type boolean;
                        default "false";
                        description "Authorize telemetry data in gNMI Subscribe RPC response";
                    }

                } // container output-authorization

                ///nokia-conf/configure/system/security/aaa/management-interface/md-cli
                container md-cli {
                    description "Enter the md-cli context";

                    ///nokia-conf/configure/system/security/aaa/management-interface/md-cli/command-accounting-during-load
                    leaf command-accounting-during-load {
                        type boolean;
                        default "true";
                        description "Perform file command accounting for load or rollback";
                    }

                } // container md-cli

            } // container management-interface

        } // container aaa

    } // grouping conf-system-security-aaa

}
