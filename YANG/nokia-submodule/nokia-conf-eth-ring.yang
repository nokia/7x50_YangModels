submodule nokia-conf-eth-ring {

    yang-version "1.1";

    belongs-to nokia-conf { prefix "conf"; }

    import ietf-yang-types                { prefix "yang"; }
    import nokia-sros-yang-extensions     { prefix "sros-ext"; }
    import nokia-types-eth-cfm            { prefix "types-eth-cfm"; }
    import nokia-types-sros               { prefix "types-sros"; }

    include nokia-conf-eth-cfm;
    include nokia-conf-groups;

    sros-ext:sros-major-release "rel23";
    organization "Nokia";
    contact
        "Nokia SR OS Support
         Web: <http://www.nokia.com>";
    description
        "Nokia YANG Data model to configure Ethernet rings on SR OS based routers.

         Copyright 2016 Nokia. All rights reserved. Reproduction of this document
         is authorized on the condition that the foregoing copyright notice is included.

         This nokia-conf-eth-ring YANG module embodies Nokia's proprietary
         intellectual property. Nokia retains all title and ownership in the
         specification, including any revisions.

         Nokia grants all interested parties a non-exclusive license to use
         and distribute an unmodified copy of this specification in connection with
         management of Nokia products, and without fee, provided this
         copyright notice and license appear on all copies.

         This specification is supplied `as is', and Nokia makes no warranty,
         either express or implied, as to the use, operation, condition, or performance
         of the specification.";
    revision "2023-01-26";

    grouping conf-eth-ring {
        ///nokia-conf/configure/eth-ring
        list eth-ring {
            key "ring-index";
            description "Enter the eth-ring list instance";

            ///nokia-conf/configure/eth-ring/ring-index
            leaf ring-index {
                type uint32 {
                    range "1..128";
                }
                description "Ring ID";
            }

            ///nokia-conf/configure/eth-ring/admin-state
            leaf admin-state {
                type types-sros:admin-state;
                default "disable";
                description "Administrative state of the Ethernet ring";
            }

            ///nokia-conf/configure/eth-ring/description
            leaf description {
                type types-sros:description-or-empty;
                description "Text description";
            }

            ///nokia-conf/configure/eth-ring/compatible-version
            leaf compatible-version {
                type uint32 {
                    range "1..2";
                }
                default "2";
                description "Compatibility version for the Ethernet ring";
            }

            ///nokia-conf/configure/eth-ring/guard-time
            leaf guard-time {
                type uint32 {
                    range "1..20";
                }
                units "deciseconds";
                default "5";
                description "Ethernet ring guard time";
            }

            ///nokia-conf/configure/eth-ring/node-id
            leaf node-id {
                type yang:mac-address;
                description "MAC address of the RPL link";
            }

            ///nokia-conf/configure/eth-ring/revert-time
            leaf revert-time {
                type uint32 {
                    range "0|60..720";
                }
                units "seconds";
                default "300";
                description "Revert time for the Ethernet ring";
            }

            ///nokia-conf/configure/eth-ring/rpl-node
            leaf rpl-node {
                type enumeration {
                    enum owner                          { value 1; }
                    enum neighbor                       { value 2; }
                }
                description "Ring Protection Link (RPL) type for the Ethernet ring";
            }

            ///nokia-conf/configure/eth-ring/apply-groups
            leaf-list apply-groups {
                type leafref {
                    path "../../groups/group/name";
                }
                max-elements 8;
                ordered-by user;
                description "Apply a configuration group at this level";
            }

            ///nokia-conf/configure/eth-ring/apply-groups-exclude
            leaf-list apply-groups-exclude {
                type leafref {
                    path "../../groups/group/name";
                }
                max-elements 8;
                ordered-by user;
                description "Exclude a configuration group at this level";
            }

            ///nokia-conf/configure/eth-ring/ccm-hold-time
            container ccm-hold-time {
                description "Enter the ccm-hold-time context";

                ///nokia-conf/configure/eth-ring/ccm-hold-time/down
                leaf down {
                    type uint32 {
                        range "1..5000";
                    }
                    units "centiseconds";
                    description "Hold timer for down event dampening";
                }

                ///nokia-conf/configure/eth-ring/ccm-hold-time/up
                leaf up {
                    type uint32 {
                        range "0..5000";
                    }
                    units "deciseconds";
                    default "20";
                    description "Hold timer for recovery reporting";
                }

            } // container ccm-hold-time

            ///nokia-conf/configure/eth-ring/sub-ring
            container sub-ring {
                description "Enter the sub-ring context";

                ///nokia-conf/configure/eth-ring/sub-ring/type
                leaf type {
                    type enumeration {
                        enum virtual-link                   { value 1; }
                        enum non-virtual-link               { value 2; }
                    }
                    description "Sub-ring type";
                }

                ///nokia-conf/configure/eth-ring/sub-ring/interconnect
                container interconnect {
                    description "Enter the interconnect context";

                    ///nokia-conf/configure/eth-ring/sub-ring/interconnect/propagate-topology-change
                    leaf propagate-topology-change {
                        type boolean;
                        default "false";
                        description "Propagate topology changes";
                    }

                    ///nokia-conf/configure/eth-ring/sub-ring/interconnect/interconnect-choice
                    choice interconnect-choice {
                        ///nokia-conf/configure/eth-ring/sub-ring/interconnect/interconnect-choice/vpls
                        case vpls {

                            ///nokia-conf/configure/eth-ring/sub-ring/interconnect/interconnect-choice/vpls/vpls
                            leaf vpls {
                                type empty;
                                description "Connect sub-ring to VPLS ID that contains sub-ring SAP";
                            }

                        }
                        ///nokia-conf/configure/eth-ring/sub-ring/interconnect/interconnect-choice/ring
                        case ring {

                            ///nokia-conf/configure/eth-ring/sub-ring/interconnect/interconnect-choice/ring/ring-id
                            leaf ring-id {
                                type leafref {
                                    path "../../../../eth-ring/ring-index";
                                }
                                description "Ring instance of the connection ring for the sub-ring";
                            }

                        }
                    }
                } // container interconnect

            } // container sub-ring

            ///nokia-conf/configure/eth-ring/path
            list path {
                key "path-index";
                description "Enter the path list instance";

                ///nokia-conf/configure/eth-ring/path/path-index
                leaf path-index {
                    type string {
                        length "1";
                        pattern "[a|b]" {
                            error-message "only characters a and b are allowed";
                        }
                    }
                    description "Path ID";
                }

                ///nokia-conf/configure/eth-ring/path/port-and-raps-tag
                leaf port-and-raps-tag {
                    type types-sros:port-and-encap;
                    sros-ext:immutable;
                    mandatory true;
                    description "Port ID and Ring APS tag ID";
                }

                ///nokia-conf/configure/eth-ring/path/admin-state
                leaf admin-state {
                    type types-sros:admin-state;
                    default "disable";
                    description "Administrative state of the Ethernet ring path";
                }

                ///nokia-conf/configure/eth-ring/path/description
                leaf description {
                    type types-sros:description-or-empty;
                    description "Text description";
                }

                ///nokia-conf/configure/eth-ring/path/rpl-end
                leaf rpl-end {
                    type boolean;
                    sros-ext:auto-restart-to-modify;
                    default "false";
                    description "Enable path as a Ring Protection Link (RPL) end";
                }

                ///nokia-conf/configure/eth-ring/path/apply-groups
                leaf-list apply-groups {
                    type leafref {
                        path "../../../groups/group/name";
                    }
                    max-elements 8;
                    ordered-by user;
                    description "Apply a configuration group at this level";
                }

                ///nokia-conf/configure/eth-ring/path/apply-groups-exclude
                leaf-list apply-groups-exclude {
                    type leafref {
                        path "../../../groups/group/name";
                    }
                    max-elements 8;
                    ordered-by user;
                    description "Exclude a configuration group at this level";
                }

                ///nokia-conf/configure/eth-ring/path/eth-cfm
                container eth-cfm {
                    description "Enter the eth-cfm context";

                    ///nokia-conf/configure/eth-ring/path/eth-cfm/mep
                    list mep {
                        key "md-admin-name ma-admin-name mep-id";
                        description "Enter the mep list instance";

                        ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/md-admin-name
                        leaf md-admin-name {
                            type leafref {
                                path "../../../../../eth-cfm/domain/md-admin-name";
                            }
                            description "Maintenance Domain (MD) name";
                        }

                        ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/ma-admin-name
                        leaf ma-admin-name {
                            type leafref {
                                path "../../../../../eth-cfm/domain[md-admin-name=current()/../md-admin-name]/association/ma-admin-name";
                            }
                            description "Maintenance Association (MA) name";
                        }

                        ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/mep-id
                        leaf mep-id {
                            type types-eth-cfm:mep-id-type;
                            description "Maintenance Endpoint (MEP) ID";
                        }

                        ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/admin-state
                        leaf admin-state {
                            type types-sros:admin-state;
                            default "disable";
                            description "Administrative state of the MEP";
                        }

                        ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/description
                        leaf description {
                            type types-sros:description;
                            description "Text description";
                        }

                        ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/mac-address
                        leaf mac-address {
                            type types-sros:mac-unicast-address-no-zero;
                            description "MAC address of the MEP";
                        }

                        ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/install-mep
                        leaf install-mep {
                            type boolean;
                            default "false";
                            description "Install MEP in the forwarding plane";
                        }

                        ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/low-priority-defect
                        leaf low-priority-defect {
                            type types-eth-cfm:lowest-alarm-priority;
                            default "all-def";
                            description "Lowest priority defect allowed to generate fault alarm";
                        }

                        ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/ccm
                        leaf ccm {
                            type boolean;
                            default "false";
                            description "Generate CCM messages";
                        }

                        ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/ccm-ltm-priority
                        leaf ccm-ltm-priority {
                            type types-eth-cfm:frame-priority;
                            default "7";
                            description "Priority of CCM and LTM messages transmitted by the MEP";
                        }

                        ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/ccm-padding-size
                        leaf ccm-padding-size {
                            type uint32 {
                                range "3..1500";
                            }
                            description "Number of octets of padding to insert in CCM packets";
                        }

                        ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/one-way-delay-threshold
                        leaf one-way-delay-threshold {
                            type uint32 {
                                range "0..600";
                            }
                            units "seconds";
                            default "3";
                            description "Threshold time limit for the one-way delay test";
                        }

                        ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/control-mep
                        leaf control-mep {
                            type boolean;
                            default "false";
                            description "Enable Ethernet ring control on the MEP";
                        }

                        ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/apply-groups
                        leaf-list apply-groups {
                            type leafref {
                                path "../../../../../groups/group/name";
                            }
                            max-elements 8;
                            ordered-by user;
                            description "Apply a configuration group at this level";
                        }

                        ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/apply-groups-exclude
                        leaf-list apply-groups-exclude {
                            type leafref {
                                path "../../../../../groups/group/name";
                            }
                            max-elements 8;
                            ordered-by user;
                            description "Exclude a configuration group at this level";
                        }

                        ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/alarm-notification
                        container alarm-notification {
                            description "Enter the alarm-notification context";

                            ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/alarm-notification/fng-alarm-time
                            leaf fng-alarm-time {
                                type int32 {
                                    range "250|500|1000";
                                }
                                units "centiseconds";
                                description "Time that must expire before an FNG alarm is raised";
                            }

                            ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/alarm-notification/fng-reset-time
                            leaf fng-reset-time {
                                type int32 {
                                    range "250|500|1000";
                                }
                                units "centiseconds";
                                description "Time that must expire before an FNG alarm is reset";
                            }

                        } // container alarm-notification

                        ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/eth-test
                        container eth-test {
                            presence "Enable the eth-test context";
                            description "Enable the eth-test context";

                            ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/eth-test/bit-error-threshold
                            leaf bit-error-threshold {
                                type uint32 {
                                    range "0..11840";
                                }
                                units "bit errors";
                                default "1";
                                description "Lowest priority defect allowed to generate fault alarm";
                            }

                            ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/eth-test/test-pattern
                            container test-pattern {
                                description "Enter the test-pattern context";

                                ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/eth-test/test-pattern/pattern
                                leaf pattern {
                                    type enumeration {
                                        enum all-zeros                      { value 0; }
                                        enum all-ones                       { value 1; }
                                    }
                                    default "all-zeros";
                                    description "Test pattern for Ethernet Test frames";
                                }

                                ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/eth-test/test-pattern/crc-tlv
                                leaf crc-tlv {
                                    type boolean;
                                    default "false";
                                    description "Generate a CRC checksum";
                                }

                            } // container test-pattern

                        } // container eth-test

                        ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/grace
                        container grace {
                            description "Enter the grace context";

                            ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/grace/eth-ed
                            container eth-ed {
                                description "Enter the eth-ed context";

                                ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/grace/eth-ed/max-rx-defect-window
                                leaf max-rx-defect-window {
                                    type uint32 {
                                        range "1..86400";
                                    }
                                    units "seconds";
                                    description "Maximum received ETH-ED expected defect window duration";
                                }

                                ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/grace/eth-ed/priority
                                leaf priority {
                                    type int32 {
                                        range "0..7";
                                    }
                                    description "Transmission priority for ETH-ED PDUs";
                                }

                                ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/grace/eth-ed/rx-eth-ed
                                leaf rx-eth-ed {
                                    type boolean;
                                    default "true";
                                    description "Receive and process ETH-ED ITU-T Y.1731 PDUs on the MEP";
                                }

                                ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/grace/eth-ed/tx-eth-ed
                                leaf tx-eth-ed {
                                    type boolean;
                                    default "false";
                                    description "Transmit ETH-ED PDUs from the MEP";
                                }

                            } // container eth-ed

                            ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/grace/eth-vsm-grace
                            container eth-vsm-grace {
                                description "Enter the eth-vsm-grace context";

                                ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/grace/eth-vsm-grace/rx-eth-vsm-grace
                                leaf rx-eth-vsm-grace {
                                    type boolean;
                                    default "true";
                                    description "Receive and process Nokia ETH-CFM Grace PDU on the MEP";
                                }

                                ///nokia-conf/configure/eth-ring/path/eth-cfm/mep/grace/eth-vsm-grace/tx-eth-vsm-grace
                                leaf tx-eth-vsm-grace {
                                    type boolean;
                                    default "true";
                                    description "Transmit ETH-ED PDUs from the MEP";
                                }

                            } // container eth-vsm-grace

                        } // container grace

                    } // list mep

                } // container eth-cfm

            } // list path

        } // list eth-ring

    } // grouping conf-eth-ring

}
